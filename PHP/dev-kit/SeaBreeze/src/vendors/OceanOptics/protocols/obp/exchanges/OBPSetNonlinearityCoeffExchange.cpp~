/***************************************************//**
 * @file    OBPSetNonlinearityCoeffExchange.cpp
 * @date    February 2012
 * @author  Ocean Optics, Inc.
 *
 * Copyright (C) 2012 Ocean Optics, Inc.
 * All rights reserved.
 *
 * Notes:
 *
 *******************************************************/

#include "common/globals.h"
#include "vendors/OceanOptics/protocols/obp/exchanges/OBPSetNonlinearityCoeffExchange.h"
#include "vendors/OceanOptics/protocols/obp/hints/OBPControlHint.h"
#include "vendors/OceanOptics/protocols/obp/constants/OBPMessageTypes.h"

using namespace seabreeze;
using namespace seabreeze::oceanBinaryProtocol;

OBPSetNonlinearityCoeffExchange::OBPSetNonlinearityCoeffExchange() {
    this->hints->push_back(new OBPControlHint());
    this->messageType = OBPMessageTypes::OBP_SET_NL_COEFF;
    this->payload.resize(1 + sizeof(float));
}

OBPSetNonlinearityCoeffExchange::~OBPSetNonlinearityCoeffExchange() {

}

void OBPSetNonlinearityCoeffExchange::setCoefficient(unsigned int index, const float coeff) {
    unsigned int *ptr = (unsigned int *) &coeff;
    this->payload[0] = index & 0x00FF;
    payload[1] = (*ptr) & 0x00FF;
    payload[2] = ((*ptr) >> 8) & 0x00FF;
    payload[3] = ((*ptr) >> 16) & 0x00FF;
    payload[4] = ((*ptr) >> 24) & 0x00FF;
}
